name: CLI PR Checks

on:
    pull_request:
        paths:
            - "cli/**"
            - ".github/workflows/cli-pr.yml"

jobs:
    test:
        runs-on: ubuntu-latest
        defaults:
            run:
                working-directory: ./cli
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Go 1.24.12
              uses: actions/setup-go@v5
              with:
                  go-version: "1.24.12"

            - name: Verify Go version
              run: go version

            - name: Setup dependencies
              run: make setup

            - name: Run tests
              run: make test

    lint:
        runs-on: ubuntu-latest
        defaults:
            run:
                working-directory: ./cli
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Go 1.24.12
              uses: actions/setup-go@v5
              with:
                  go-version: "1.24.12"

            - name: Verify Go version
              run: go version

            - name: Setup dependencies
              run: make setup

            - name: Install golangci-lint
              run: go install github.com/golangci/golangci-lint/cmd/golangci-lint@v1.64.5

            - name: Run lint
              run: make lint
